<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Password Enforcer - Advanced Password Security</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary-blue: #00aaff;
            --secondary-blue: #0088ff;
            --dark-bg: #0c0c2e;
            --medium-bg: #1a1a3e;
            --container-bg: rgba(20, 20, 50, 0.85);
            --success-green: #00ff88;
            --warning-orange: #ffaa00;
            --error-red: #ff5555;
            --text-light: #e0e0ff;
            --text-muted: #a0a0ff;
            --border-color: rgba(100, 100, 255, 0.2);
        }

        body {
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--medium-bg) 100%);
            color: var(--text-light);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1rem;
            position: relative;
            overflow-x: hidden;
            line-height: 1.6;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(0, 150, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 80% 70%, rgba(100, 0, 255, 0.1) 0%, transparent 20%);
            z-index: -1;
        }

        .container {
            max-width: 900px;
            width: 100%;
            background: var(--container-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
            margin: 0.5rem;
        }

        .container::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(to bottom right, transparent 30%, rgba(0, 150, 255, 0.1) 50%, transparent 70%);
            animation: shine 8s infinite linear;
            z-index: -1;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(0deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(360deg); }
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 2rem;
        }

        h1 {
            font-size: clamp(2rem, 5vw, 2.8rem);
            background: linear-gradient(90deg, var(--primary-blue), var(--secondary-blue));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            flex-wrap: wrap;
        }

        .tagline {
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            color: var(--text-muted);
            margin-bottom: 1rem;
            line-height: 1.4;
        }

        .cyber-border {
            height: 3px;
            width: 100%;
            background: linear-gradient(90deg, transparent, var(--primary-blue), var(--secondary-blue), transparent);
            margin: 0.5rem 0 1.5rem 0;
        }

        /* Password Input */
        .password-input-container {
            position: relative;
            margin-bottom: 1rem;
        }

        .password-input {
            width: 100%;
            padding: 1.2rem 3.5rem 1.2rem 3rem;
            font-size: clamp(1rem, 4vw, 1.2rem);
            background: rgba(10, 10, 30, 0.8);
            border: 2px solid #333366;
            border-radius: 10px;
            color: var(--text-light);
            outline: none;
            transition: all 0.3s;
            -webkit-appearance: none;
            appearance: none;
        }

        .password-input:focus {
            border-color: var(--primary-blue);
            box-shadow: 0 0 15px rgba(0, 170, 255, 0.3);
        }

        .password-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-blue);
            font-size: 1.2rem;
            pointer-events: none;
        }

        .toggle-visibility {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0.5rem;
            min-width: 44px;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Strength Meter */
        .strength-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-weight: 600;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }

        .strength-meter {
            height: 10px;
            width: 100%;
            background: rgba(30, 30, 60, 0.8);
            border-radius: 5px;
            margin: 1.5rem 0;
            overflow: hidden;
        }

        .strength-fill {
            height: 100%;
            width: 0%;
            border-radius: 5px;
            transition: width 0.5s ease, background 0.5s ease;
        }

        /* Requirements */
        .requirements {
            background: rgba(10, 10, 30, 0.6);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .requirements h3 {
            color: var(--primary-blue);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: clamp(1.1rem, 4vw, 1.3rem);
        }

        .requirement-list {
            list-style: none;
        }

        .requirement-item {
            padding: 0.8rem 0;
            border-bottom: 1px solid rgba(100, 100, 150, 0.3);
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }

        .requirement-item:last-child {
            border-bottom: none;
        }

        .requirement-icon {
            font-size: 1.2rem;
            width: 24px;
            flex-shrink: 0;
        }

        .requirement-met {
            color: var(--success-green);
        }

        .requirement-not-met {
            color: var(--error-red);
        }

        /* Result Section */
        .result {
            text-align: center;
            padding: 1.5rem;
            border-radius: 10px;
            margin-top: 1.5rem;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .result-strong {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            color: var(--success-green);
        }

        .result-weak {
            background: rgba(255, 85, 85, 0.1);
            border: 1px solid rgba(255, 85, 85, 0.3);
            color: var(--error-red);
        }

        .result-medium {
            background: rgba(255, 170, 0, 0.1);
            border: 1px solid rgba(255, 170, 0, 0.3);
            color: var(--warning-orange);
        }

        .strength-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .detail-box {
            background: rgba(20, 20, 40, 0.8);
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
            border: 1px solid var(--border-color);
            min-width: 0;
        }

        .detail-value {
            font-size: clamp(1.5rem, 5vw, 1.8rem);
            font-weight: bold;
            margin: 0.5rem 0;
        }

        .score-excellent { color: var(--success-green); }
        .score-good { color: #a0ff60; }
        .score-fair { color: var(--warning-orange); }
        .score-poor { color: var(--error-red); }

        /* Generator */
        .generator-container {
            background: rgba(10, 10, 30, 0.6);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border: 1px solid var(--border-color);
        }

        .generator-header {
            margin-bottom: 1.5rem;
        }

        .generator-header h3 {
            color: var(--primary-blue);
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: clamp(1.1rem, 4vw, 1.3rem);
            margin-bottom: 1rem;
        }

        .generator-controls {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .length-control {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .length-display {
            min-width: 70px;
            text-align: center;
            font-weight: bold;
            color: var(--primary-blue);
            font-size: clamp(1rem, 4vw, 1.2rem);
        }

        .length-slider {
            flex: 1;
            min-width: 0;
            height: 6px;
            border-radius: 3px;
            background: rgba(30, 30, 60, 0.8);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .length-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-blue);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        }

        .length-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-blue);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        }

        .generate-btn {
            background: linear-gradient(90deg, var(--primary-blue), var(--secondary-blue));
            color: white;
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            font-size: clamp(0.9rem, 3vw, 1rem);
            min-height: 44px;
            width: 100%;
        }

        .generate-btn:hover, .generate-btn:active {
            background: linear-gradient(90deg, var(--secondary-blue), #0066cc);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 136, 255, 0.3);
        }

        .generated-passwords {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .generated-password {
            background: rgba(20, 20, 40, 0.8);
            border-radius: 8px;
            padding: 1rem;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        .generated-password:hover, .generated-password:active {
            border-color: var(--primary-blue);
            background: rgba(30, 30, 60, 0.9);
            transform: translateY(-2px);
        }

        .password-text {
            font-family: 'Courier New', monospace;
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            color: var(--text-light);
            margin-bottom: 0.8rem;
            word-break: break-all;
            line-height: 1.4;
        }

        .password-strength {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
        }

        .password-copy {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1rem;
            padding: 0.3rem;
            min-width: 30px;
            min-height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Alerts */
        .alert-container {
            margin: 1.5rem 0;
        }

        .alert {
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.8rem;
            animation: slideIn 0.3s ease;
            border-left: 5px solid;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .alert-danger {
            background: rgba(255, 50, 50, 0.15);
            border-color: var(--error-red);
            color: #ff9999;
        }

        .alert-warning {
            background: rgba(255, 170, 0, 0.15);
            border-color: var(--warning-orange);
            color: #ffcc66;
        }

        .alert-info {
            background: rgba(0, 150, 255, 0.15);
            border-color: var(--primary-blue);
            color: #99ddff;
        }

        .alert-success {
            background: rgba(0, 255, 136, 0.15);
            border-color: var(--success-green);
            color: #99ffcc;
        }

        .alert-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
            margin-top: 0.1rem;
        }

        .alert-content {
            flex-grow: 1;
        }

        .alert-title {
            font-weight: bold;
            margin-bottom: 0.3rem;
            font-size: 1rem;
        }

        .alert-message {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* API Status */
        .api-status {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            background: rgba(20, 20, 40, 0.8);
            font-size: 0.85rem;
            margin-top: 0.5rem;
            border: 1px solid var(--border-color);
            justify-content: center;
            flex-wrap: wrap;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--error-red);
            flex-shrink: 0;
        }

        .status-dot.online {
            background: var(--success-green);
            box-shadow: 0 0 8px rgba(0, 255, 136, 0.5);
        }

        .status-dot.offline {
            background: var(--warning-orange);
            box-shadow: 0 0 8px rgba(255, 170, 0, 0.5);
        }

        .status-text {
            color: var(--text-muted);
        }

        /* Security Tips */
        .security-tips {
            background: rgba(10, 10, 30, 0.6);
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .security-tips h3 {
            color: var(--warning-orange);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: clamp(1.1rem, 4vw, 1.3rem);
        }

        .tip {
            padding: 0.5rem 0;
            display: flex;
            align-items: flex-start;
            gap: 0.8rem;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }

        .tip i {
            color: var(--warning-orange);
            margin-top: 0.2rem;
            flex-shrink: 0;
        }

        /* Footer */
        footer {
            margin-top: 2rem;
            text-align: center;
            color: #8080cc;
            font-size: 0.85rem;
            width: 100%;
            max-width: 900px;
            border-top: 1px solid var(--border-color);
            padding-top: 1.5rem;
            line-height: 1.5;
        }

        .highlight {
            color: var(--primary-blue);
            font-weight: 600;
        }

        /* Loading Spinner */
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 1rem;
            color: var(--primary-blue);
        }

        .spinner {
            border: 3px solid rgba(0, 170, 255, 0.3);
            border-top: 3px solid var(--primary-blue);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Touch-friendly improvements */
        button, input[type="range"] {
            touch-action: manipulation;
        }

        /* Score Breakdown */
        .score-breakdown {
            background: rgba(10, 10, 30, 0.6);
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .score-breakdown h3 {
            color: var(--primary-blue);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: clamp(1.1rem, 4vw, 1.3rem);
        }

        .score-category {
            margin-bottom: 1.5rem;
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(100, 100, 150, 0.3);
            font-size: clamp(0.9rem, 3vw, 1rem);
        }

        .category-name {
            font-weight: 600;
        }

        .category-score {
            font-weight: bold;
        }

        .score-meter {
            height: 8px;
            background: rgba(30, 30, 60, 0.8);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .score-fill {
            height: 100%;
            transition: width 0.5s ease;
        }

        .score-items {
            font-size: 0.85rem;
            color: var(--text-muted);
            padding-left: 1rem;
        }

        .score-item {
            margin: 0.3rem 0;
            display: flex;
            justify-content: space-between;
        }

        .penalty {
            color: var(--error-red);
        }

        .bonus {
            color: var(--success-green);
        }

        /* Breach Data */
        .breach-data {
            background: rgba(20, 20, 40, 0.8);
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            border: 1px solid rgba(255, 50, 50, 0.3);
            display: none;
        }

        .breach-data h4 {
            color: var(--error-red);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: clamp(1rem, 4vw, 1.2rem);
        }

        .breach-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.8rem;
            margin-top: 1rem;
        }

        .breach-item {
            background: rgba(255, 50, 50, 0.1);
            padding: 0.8rem;
            border-radius: 8px;
            border-left: 4px solid var(--error-red);
        }

        .breach-label {
            font-size: 0.9rem;
            color: #ff9999;
            margin-bottom: 0.3rem;
        }

        .breach-value {
            font-weight: bold;
            color: #ffcccc;
        }

        .breach-sources {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(255, 50, 50, 0.05);
            border-radius: 8px;
            border-left: 3px solid var(--error-red);
        }

        .breach-source-list {
            list-style: none;
            margin-top: 0.5rem;
        }

        .breach-source-item {
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 100, 100, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .breach-source-item:last-child {
            border-bottom: none;
        }

        .breach-source-name {
            font-weight: bold;
            color: #ff9999;
        }

        .breach-source-count {
            color: #ffcccc;
            font-size: 0.9rem;
        }

        /* Responsive Breakpoints */
        @media (min-width: 640px) {
            body {
                padding: 1.5rem;
            }
            
            .container {
                padding: 2rem;
            }
            
            .generator-controls {
                flex-direction: row;
                align-items: center;
            }
            
            .generate-btn {
                width: auto;
                min-width: 140px;
            }
            
            .length-control {
                flex: 1;
            }
        }

        @media (min-width: 768px) {
            .container {
                padding: 2.5rem;
            }
            
            h1 {
                flex-direction: row;
            }
            
            .generated-passwords {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .strength-details {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .generated-passwords {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
            
            .generator-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .generator-header h3 {
                margin-bottom: 0;
            }
            
            .generator-controls {
                flex-direction: row;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 1.2rem;
                border-radius: 15px;
            }
            
            .requirements, .security-tips, .score-breakdown, .generator-container {
                padding: 1.2rem;
            }
            
            .password-input {
                padding: 1rem 3rem 1rem 2.5rem;
            }
            
            .toggle-visibility {
                right: 0.8rem;
            }
            
            .generated-passwords {
                grid-template-columns: 1fr;
            }
            
            .strength-details {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Small mobile devices */
        @media (max-width: 360px) {
            body {
                padding: 0.8rem;
            }
            
            .container {
                padding: 1rem;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .detail-box {
                padding: 0.8rem;
            }
            
            .strength-details {
                gap: 0.8rem;
            }
        }

        /* Landscape mode */
        @media (max-height: 600px) and (orientation: landscape) {
            body {
                padding: 1rem;
            }
            
            .container {
                max-width: 95%;
            }
            
            .password-input-container {
                margin-bottom: 0.8rem;
            }
            
            .requirements, .security-tips {
                margin: 1rem 0;
                padding: 1rem;
            }
            
            .generated-passwords {
                max-height: 200px;
                overflow-y: auto;
            }
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .password-input {
                border-width: 3px;
            }
            
            .strength-meter {
                height: 12px;
            }
            
            .alert {
                border-left-width: 6px;
            }
        }

        /* Reduced motion */
        @media (prefers-reduced-motion: reduce) {
            .container::after, .spinner, .strength-fill, .alert {
                animation: none;
                transition: none;
            }
        }

        /* Dark mode adjustments (already dark, but for consistency) */
        @media (prefers-color-scheme: dark) {
            .container {
                background: rgba(15, 15, 35, 0.9);
            }
        }

        /* Print styles */
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .container {
                box-shadow: none;
                border: 1px solid #ccc;
                background: white;
            }
            
            .generate-btn, .toggle-visibility {
                display: none;
            }
            
            .password-input {
                border: 1px solid #ccc;
                color: black;
                background: white;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-shield-alt"></i> Password Enforcer</h1>
            <div class="tagline">Advanced Password Policy Enforcement with Real Breach Data</div>
            <div class="cyber-border"></div>
            <div class="api-status" id="apiStatus">
                <div class="status-dot" id="statusDot"></div>
                <span class="status-text" id="statusText">Connecting to database...</span>
            </div>
        </header>

        <div class="password-input-container">
            <i class="fas fa-key password-icon"></i>
            <input type="password" id="passwordInput" class="password-input" placeholder="Enter password to analyze..." autocomplete="off" aria-label="Password input">
            <button id="toggleVisibility" class="toggle-visibility" aria-label="Toggle password visibility">
                <i class="fas fa-eye"></i>
            </button>
        </div>

        <div class="strength-label">
            <span>Password Strength:</span>
            <span id="strengthText">Very Weak</span>
        </div>
        <div class="strength-meter">
            <div id="strengthFill" class="strength-fill"></div>
        </div>

        <!-- Password Generator -->
        <div class="generator-container">
            <div class="generator-header">
                <h3><i class="fas fa-magic"></i> Generate Strong Password</h3>
            </div>
            <div class="generator-controls">
                <div class="length-control">
                    <div class="length-display" id="lengthDisplay">24</div>
                    <input type="range" id="lengthSlider" class="length-slider" min="20" max="32" value="24" step="1" aria-label="Password length">
                    <button id="generateBtn" class="generate-btn">
                        <i class="fas fa-bolt"></i> Generate
                    </button>
                </div>
            </div>
            <div class="generated-passwords" id="generatedPasswords">
                <!-- Generated passwords will appear here -->
            </div>
        </div>

        <!-- Loading Spinner -->
        <div class="loading-spinner" id="loadingSpinner">
            <div class="spinner"></div>
            <p>Checking data breaches...</p>
        </div>

        <!-- Alert Container -->
        <div class="alert-container" id="alertContainer">
            <!-- Alerts will be dynamically inserted here -->
        </div>

        <div class="requirements">
            <h3><i class="fas fa-clipboard-check"></i> Password Policy Requirements</h3>
            <ul class="requirement-list" id="requirementList">
                <li class="requirement-item" id="reqLength">
                    <i class="fas fa-times-circle requirement-icon requirement-not-met" id="iconLength"></i>
                    <span>At least 12 characters long</span>
                </li>
                <li class="requirement-item" id="reqUppercase">
                    <i class="fas fa-times-circle requirement-icon requirement-not-met" id="iconUppercase"></i>
                    <span>Contains uppercase letters (A-Z)</span>
                </li>
                <li class="requirement-item" id="reqLowercase">
                    <i class="fas fa-times-circle requirement-icon requirement-not-met" id="iconLowercase"></i>
                    <span>Contains lowercase letters (a-z)</span>
                </li>
                <li class="requirement-item" id="reqNumbers">
                    <i class="fas fa-times-circle requirement-icon requirement-not-met" id="iconNumbers"></i>
                    <span>Contains numbers (0-9)</span>
                </li>
                <li class="requirement-item" id="reqSpecial">
                    <i class="fas fa-times-circle requirement-icon requirement-not-met" id="iconSpecial"></i>
                    <span>Contains special characters (!@#$%^&*)</span>
                </li>
                <li class="requirement-item" id="reqNoCommon">
                    <i class="fas fa-times-circle requirement-icon requirement-not-met" id="iconNoCommon"></i>
                    <span>Not a common password</span>
                </li>
                <li class="requirement-item" id="reqNotBreached">
                    <i class="fas fa-times-circle requirement-icon requirement-not-met" id="iconNotBreached"></i>
                    <span>Not found in known data breaches</span>
                </li>
                <li class="requirement-item" id="reqNoPatterns">
                    <i class="fas fa-times-circle requirement-icon requirement-not-met" id="iconNoPatterns"></i>
                    <span>No weak patterns detected</span>
                </li>
            </ul>
        </div>

        <!-- Score Breakdown -->
        <div class="score-breakdown" id="scoreBreakdown">
            <h3><i class="fas fa-chart-bar"></i> Security Score Breakdown</h3>
            <div id="breakdownContent">
                <!-- Score breakdown will be populated here -->
            </div>
        </div>

        <!-- Breach Data Display -->
        <div class="breach-data" id="breachData">
            <h4><i class="fas fa-database"></i> Real-time Breach Information</h4>
            <p style="margin-bottom: 1rem;">This password has been found in data breaches!</p>
            <div class="breach-info" id="breachInfo">
                <!-- Breach info will be populated here -->
            </div>
            <div class="breach-sources" id="breachSources">
                <h5>Recent Major Breaches Containing This Password:</h5>
                <ul class="breach-source-list" id="breachSourceList">
                    <!-- Breach sources will be populated here -->
                </ul>
            </div>
        </div>

        <div id="result" class="result">
            <h3 id="resultTitle">Password Assessment</h3>
            <p id="resultMessage">Your password needs to meet all requirements for a strong security rating.</p>
            
            <div class="strength-details">
                <div class="detail-box">
                    <div>Security Score</div>
                    <div class="detail-value score-poor" id="scoreValue">0/100</div>
                    <div>Overall Rating</div>
                </div>
                <div class="detail-box">
                    <div>Password Length</div>
                    <div class="detail-value" id="passwordLength">0</div>
                    <div>Characters</div>
                </div>
                <div class="detail-box">
                    <div>Character Types</div>
                    <div class="detail-value" id="charTypes">0/4</div>
                    <div>Uppercase, Lowercase, Numbers, Special</div>
                </div>
                <div class="detail-box">
                    <div>Breach Status</div>
                    <div class="detail-value" id="breachStatus">Unknown</div>
                </div>
            </div>
        </div>

        <div class="security-tips">
            <h3><i class="fas fa-lightbulb"></i> Cyber Security Tips</h3>
            <div class="tip"><i class="fas fa-check-circle"></i> Use a unique password for each account</div>
            <div class="tip"><i class="fas fa-check-circle"></i> Consider using a password manager</div>
            <div class="tip"><i class="fas fa-check-circle"></i> Enable two-factor authentication (2FA)</div>
            <div class="tip"><i class="fas fa-check-circle"></i> Change passwords after data breaches</div>
            <div class="tip"><i class="fas fa-check-circle"></i> Avoid personal information in passwords</div>
            <div class="tip"><i class="fas fa-check-circle"></i> Check passwords regularly with HIBP</div>
            <div class="tip"><i class="fas fa-check-circle"></i> Longer passwords are more secure than complex ones</div>
        </div>
    </div>

    <footer>
        <p><span class="highlight">Password Enforcer</span> | Advanced Password Policy Enforcement with Real-time Breach Data</p>
        <p>Privacy Notice: Passwords are securely hashed locally before checking - never sent in plain text</p>
        <p style="margin-top: 0.5rem; font-size: 0.8rem;">Responsive design optimized for all devices</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const passwordInput = document.getElementById('passwordInput');
            const toggleVisibility = document.getElementById('toggleVisibility');
            const strengthFill = document.getElementById('strengthFill');
            const strengthText = document.getElementById('strengthText');
            const resultDiv = document.getElementById('result');
            const resultTitle = document.getElementById('resultTitle');
            const resultMessage = document.getElementById('resultMessage');
            const scoreValue = document.getElementById('scoreValue');
            const passwordLength = document.getElementById('passwordLength');
            const charTypes = document.getElementById('charTypes');
            const breachStatus = document.getElementById('breachStatus');
            const alertContainer = document.getElementById('alertContainer');
            const breachDataDiv = document.getElementById('breachData');
            const breachInfoDiv = document.getElementById('breachInfo');
            const breachSourcesDiv = document.getElementById('breachSources');
            const breachSourceList = document.getElementById('breachSourceList');
            const scoreBreakdown = document.getElementById('scoreBreakdown');
            const breakdownContent = document.getElementById('breakdownContent');
            const lengthSlider = document.getElementById('lengthSlider');
            const lengthDisplay = document.getElementById('lengthDisplay');
            const generateBtn = document.getElementById('generateBtn');
            const generatedPasswordsDiv = document.getElementById('generatedPasswords');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const apiStatus = document.getElementById('apiStatus');
            const statusDot = document.getElementById('statusDot');
            const statusText = document.getElementById('statusText');

            // Character sets for password generation
            const uppercaseChars = 'ABCDEFGHJKLMNPQRSTUVWXYZ';
            const lowercaseChars = 'abcdefghijkmnpqrstuvwxyz';
            const numberChars = '23456789';
            const specialChars = '!@#$%^&*()_+-=[]{}|;:,.<>?';

            // Common passwords list
            const commonPasswords = [
                'password', '123456', '12345678', '123456789', '1234567890',
                'admin', 'qwerty', 'letmein', 'welcome', 'monkey',
                'password1', 'abc123', 'football', '123123', 'superman',
                'iloveyou', 'sunshine', 'trustno1', 'dragon', 'baseball',
                'hello', 'michael', 'charlie', 'jordan', 'harley'
            ];

            // Weak patterns with severity scores
            const weakPatterns = [
                { pattern: /^[0-9]+$/, name: 'Numbers only', severity: 30 },
                { pattern: /^[a-z]+$/, name: 'Lowercase only', severity: 20 },
                { pattern: /^[A-Z]+$/, name: 'Uppercase only', severity: 20 },
                { pattern: /^[!@#$%^&*]+$/, name: 'Special chars only', severity: 20 },
                { pattern: /(.)\1{3,}/, name: 'Repeating characters', severity: 25 },
                { pattern: /(123|234|345|456|567|678|789|012)/, name: 'Simple number sequences', severity: 25 },
                { pattern: /(qwerty|asdfgh|zxcvbn|qazwsx)/i, name: 'Keyboard patterns', severity: 30 },
                { pattern: /(admin|root|user|pass|login)/i, name: 'Common security terms', severity: 15 },
                { pattern: /\b(january|february|march|april|may|june|july|august|september|october|november|december)\b/i, name: 'Month names', severity: 10 },
                { pattern: /\b(monday|tuesday|wednesday|thursday|friday|saturday|sunday)\b/i, name: 'Day names', severity: 10 },
                { pattern: /\b(19|20)\d{2}\b/, name: 'Year patterns', severity: 15 },
                { pattern: /(.)\1{2,}/, name: 'Triple repeating chars', severity: 15 },
                { pattern: /(abc|bcd|cde|def|efg|fgh|ghi|hij|ijk|jkl|klm|lmn|mno|nop|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz)/i, name: 'Alphabet sequences', severity: 20 }
            ];

            // Requirement elements
            const reqElements = {
                length: { item: document.getElementById('reqLength'), icon: document.getElementById('iconLength') },
                uppercase: { item: document.getElementById('reqUppercase'), icon: document.getElementById('iconUppercase') },
                lowercase: { item: document.getElementById('reqLowercase'), icon: document.getElementById('iconLowercase') },
                numbers: { item: document.getElementById('reqNumbers'), icon: document.getElementById('iconNumbers') },
                special: { item: document.getElementById('reqSpecial'), icon: document.getElementById('iconSpecial') },
                noCommon: { item: document.getElementById('reqNoCommon'), icon: document.getElementById('iconNoCommon') },
                notBreached: { item: document.getElementById('reqNotBreached'), icon: document.getElementById('iconNotBreached') },
                noPatterns: { item: document.getElementById('reqNoPatterns'), icon: document.getElementById('iconNoPatterns') }
            };

            // API status tracking
            let apiOnline = false;

            // Initialize
            init();

            function init() {
                // Test API connection
                testApiConnection();
                
                // Event listeners
                toggleVisibility.addEventListener('click', togglePasswordVisibility);
                lengthSlider.addEventListener('input', updateLengthDisplay);
                generateBtn.addEventListener('click', generateStrongPasswords);
                passwordInput.addEventListener('input', handlePasswordInput);
                
                // Generate initial passwords
                generateStrongPasswords();
                
                // Set example password
                setTimeout(() => {
                    const examplePassword = "";
                    passwordInput.value = examplePassword;
                    analyzePassword(examplePassword);
                }, 500);
            }

            // Toggle password visibility
            function togglePasswordVisibility() {
                const type = passwordInput.type === 'password' ? 'text' : 'password';
                passwordInput.type = type;
                this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
            }

            // Update length display
            function updateLengthDisplay() {
                lengthDisplay.textContent = this.value;
            }

            // Handle password input with debounce
            let debounceTimer;
            function handlePasswordInput() {
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(() => {
                    analyzePassword(this.value);
                }, 300);
            }

            // Test API connection
            async function testApiConnection() {
                try {
                    const testResponse = await fetch('https://api.pwnedpasswords.com/range/5BAA6');
                    
                    if (testResponse.ok) {
                        apiOnline = true;
                        statusDot.className = 'status-dot online';
                        statusText.textContent = 'Connected to database';
                    } else {
                        apiOnline = false;
                        statusDot.className = 'status-dot offline';
                        statusText.textContent = 'HIBP API temporarily unavailable';
                    }
                } catch (error) {
                    apiOnline = false;
                    statusDot.className = 'status-dot offline';
                    statusText.textContent = 'HIBP API unavailable - Using offline mode';
                }
            }

            // Generate strong passwords
            function generateStrongPasswords() {
                const length = parseInt(lengthSlider.value);
                generatedPasswordsDiv.innerHTML = '';
                
                // Generate 3 different types of strong passwords
                const passwords = [
                    generateRandomPassword(length),
                    generatePatternPassword(length),
                    generateMemorablePassword(length)
                ];
                
                passwords.forEach(password => {
                    const passwordElement = createPasswordElement(password);
                    generatedPasswordsDiv.appendChild(passwordElement);
                    
                    // Test the password to ensure it scores high
                    setTimeout(() => {
                        analyzeGeneratedPassword(password, passwordElement);
                    }, 100);
                });
            }

            // Create password element for display
            function createPasswordElement(password) {
                const div = document.createElement('div');
                div.className = 'generated-password';
                div.innerHTML = `
                    <div class="password-text">${password}</div>
                    <div class="password-strength">
                        <div class="strength-indicator">
                            <span>Strength:</span>
                            <div class="strength-dot"></div>
                            <span class="strength-text">Testing...</span>
                        </div>
                        <span class="password-score">Score: --/100</span>
                    </div>
                    <i class="fas fa-copy password-copy" title="Copy to clipboard"></i>
                `;
                
                // Add copy functionality
                const copyBtn = div.querySelector('.password-copy');
                copyBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    copyToClipboard(password);
                    
                    // Visual feedback
                    const originalIcon = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i>';
                    this.style.color = '#00ff88';
                    
                    setTimeout(() => {
                        this.innerHTML = originalIcon;
                        this.style.color = '';
                    }, 2000);
                });
                
                // Click to fill input
                div.addEventListener('click', function() {
                    passwordInput.value = password;
                    analyzePassword(password);
                    passwordInput.focus();
                    
                    // Scroll to input
                    passwordInput.scrollIntoView({ behavior: 'smooth', block: 'center' });
                });
                
                return div;
            }

            // Analyze generated password and update display
            function analyzeGeneratedPassword(password, element) {
                const analysis = quickAnalyzePassword(password);
                
                // Update strength indicator
                const strengthDot = element.querySelector('.strength-dot');
                const strengthText = element.querySelector('.strength-text');
                const scoreElement = element.querySelector('.password-score');
                
                // Set strength dot class
                strengthDot.className = 'strength-dot';
                if (analysis.score >= 90) {
                    strengthDot.style.background = '#00ff88';
                    strengthText.textContent = 'Excellent';
                } else if (analysis.score >= 80) {
                    strengthDot.style.background = '#00ff88';
                    strengthText.textContent = 'Strong';
                } else if (analysis.score >= 60) {
                    strengthDot.style.background = '#a0ff60';
                    strengthText.textContent = 'Good';
                } else if (analysis.score >= 40) {
                    strengthDot.style.background = '#ffaa00';
                    strengthText.textContent = 'Fair';
                } else {
                    strengthDot.style.background = '#ff5555';
                    strengthText.textContent = 'Weak';
                }
                
                scoreElement.textContent = `Score: ${analysis.score}/100`;
                scoreElement.style.color = analysis.scoreColor;
                
                // Highlight if it's a perfect 100
                if (analysis.score === 100) {
                    element.style.borderColor = '#00ff88';
                    element.style.boxShadow = '0 0 10px rgba(0, 255, 136, 0.3)';
                }
            }

            // Quick analysis for generated passwords
            function quickAnalyzePassword(password) {
                let score = 0;
                
                // Length score (25 points)
                if (password.length >= 24) score += 25;
                else if (password.length >= 20) score += 25;
                else if (password.length >= 16) score += 20;
                else if (password.length >= 12) score += 15;
                else if (password.length >= 8) score += 10;
                else if (password.length >= 6) score += 5;
                else score += 2;
                
                // Complexity score (30 points)
                const hasUppercase = /[A-Z]/.test(password);
                const hasLowercase = /[a-z]/.test(password);
                const hasNumbers = /\d/.test(password);
                const hasSpecial = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password);
                
                if (hasUppercase) score += 5;
                if (hasLowercase) score += 5;
                if (hasNumbers) score += 5;
                if (hasSpecial) score += 10;
                if (hasUppercase && hasLowercase && hasNumbers && hasSpecial) score += 5;
                
                // Security score (25 points) - assume no issues for generated passwords
                score += 25;
                
                // Cap at 100
                score = Math.min(score, 100);
                
                // Determine strength class
                let scoreColor = '#ff5555';
                
                if (score >= 90) {
                    scoreColor = '#00ff88';
                } else if (score >= 80) {
                    scoreColor = '#00ff88';
                } else if (score >= 60) {
                    scoreColor = '#a0ff60';
                } else if (score >= 40) {
                    scoreColor = '#ffaa00';
                }
                
                return { score: score, scoreColor: scoreColor };
            }

            // Generate a random password
            function generateRandomPassword(length = 24) {
                const allChars = uppercaseChars + lowercaseChars + numberChars + specialChars;
                let password = '';
                
                // Start with one of each required character type
                password += getRandomChar(uppercaseChars);
                password += getRandomChar(lowercaseChars);
                password += getRandomChar(numberChars);
                password += getRandomChar(specialChars);
                
                // Fill the rest with random characters
                for (let i = password.length; i < length; i++) {
                    password += getRandomChar(allChars);
                }
                
                // Shuffle the password
                return shuffleString(password);
            }

            // Generate password with pattern
            function generatePatternPassword(length = 24) {
                const groups = Math.ceil(length / 5);
                let password = '';
                
                for (let i = 0; i < groups; i++) {
                    password += getRandomChar(uppercaseChars);
                    password += getRandomChar(lowercaseChars);
                    password += getRandomChar(numberChars);
                    password += getRandomChar(specialChars);
                    
                    if (i < groups - 1) {
                        password += getRandomChar('-_');
                    }
                }
                
                return password.substring(0, length);
            }

            // Generate memorable password
            function generateMemorablePassword(length = 24) {
                const words = ['Quantum', 'Photon', 'Nebula', 'Galaxy', 'Orbit', 'Cosmic', 'Stellar', 'Vector'];
                const separators = ['@', '#', '$', '%', '&', '*'];
                
                let password = '';
                
                while (password.length < length) {
                    const word = words[Math.floor(Math.random() * words.length)];
                    const separator = separators[Math.floor(Math.random() * separators.length)];
                    const number = Math.floor(Math.random() * 90) + 10;
                    
                    let modifiedWord = word;
                    if (Math.random() > 0.5) {
                        modifiedWord = word.split('').map(c => 
                            Math.random() > 0.7 ? c.toUpperCase() : c.toLowerCase()
                        ).join('');
                    }
                    
                    password += modifiedWord + separator + number;
                    
                    if (password.length < length - 3) {
                        password += getRandomChar(specialChars);
                    }
                }
                
                // Ensure all required character types
                password = password.substring(0, length);
                if (!/[A-Z]/.test(password)) password = 'A' + password.substring(1);
                if (!/[a-z]/.test(password)) password = password.substring(0, password.length - 1) + 'z';
                if (!/\d/.test(password)) password = password.substring(0, password.length - 1) + '7';
                if (!/[^a-zA-Z0-9]/.test(password)) password = password.substring(0, password.length - 1) + '@';
                
                return password;
            }

            // Helper function to get random character
            function getRandomChar(chars) {
                return chars[Math.floor(Math.random() * chars.length)];
            }

            // Helper function to shuffle string
            function shuffleString(str) {
                const array = str.split('');
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array.join('');
            }

            // Copy to clipboard
            function copyToClipboard(text) {
                navigator.clipboard.writeText(text).then(() => {
                    // Show success message
                    const alert = document.createElement('div');
                    alert.className = 'alert alert-success';
                    alert.innerHTML = `
                        <i class="fas fa-check-circle alert-icon"></i>
                        <div class="alert-content">
                            <div class="alert-title">Password Copied!</div>
                            <div class="alert-message">Password copied to clipboard</div>
                        </div>
                    `;
                    alertContainer.appendChild(alert);
                    
                    // Remove after 3 seconds
                    setTimeout(() => {
                        if (alert.parentNode) {
                            alert.remove();
                        }
                    }, 3000);
                }).catch(err => {
                    console.error('Failed to copy: ', err);
                });
            }

            // Main password analysis function
            async function analyzePassword(password) {
                clearAlerts();
                breachDataDiv.style.display = 'none';
                breachSourcesDiv.style.display = 'none';
                breachInfoDiv.innerHTML = '';
                breachSourceList.innerHTML = '';
                
                let totalScore = 0;
                let alerts = [];
                
                // Create breakdown object
                const breakdown = {
                    length: { score: 0, max: 25, items: [] },
                    complexity: { score: 0, max: 30, items: [] },
                    security: { score: 0, max: 25, items: [] },
                    penalties: { score: 0, max: 0, items: [] }
                };
                
                // 1. LENGTH ANALYSIS (25 points)
                const lengthResult = calculateLengthScore(password);
                breakdown.length.score = lengthResult.score;
                breakdown.length.items = lengthResult.items;
                totalScore += lengthResult.score;
                
                // 2. COMPLEXITY ANALYSIS (30 points)
                const complexityResult = calculateComplexityScore(password);
                breakdown.complexity.score = complexityResult.score;
                breakdown.complexity.items = complexityResult.items;
                totalScore += complexityResult.score;
                
                // 3. SECURITY ANALYSIS (25 points)
                const securityResult = calculateSecurityScore(password);
                breakdown.security.score = securityResult.score;
                breakdown.security.items = securityResult.items;
                totalScore += securityResult.score;
                
                // 4. PENALTIES FOR WEAKNESSES
                const penaltyResult = calculatePenalties(password);
                breakdown.penalties.score = penaltyResult.score;
                breakdown.penalties.items = penaltyResult.items;
                breakdown.penalties.max = Math.abs(penaltyResult.score);
                totalScore += penaltyResult.score;
                
                // Check breach status (simulated)
                const breachResult = await checkPasswordBreach(password);
                if (breachResult.found) {
                    const breachPenalty = breachResult.count > 10000 ? 20 : breachResult.count > 1000 ? 15 : 10;
                    breakdown.security.score = Math.max(0, breakdown.security.score - breachPenalty);
                    breakdown.security.items.push(`Found in ${breachResult.count.toLocaleString()} breaches: -${breachPenalty}`);
                    totalScore = breakdown.length.score + breakdown.complexity.score + breakdown.security.score + breakdown.penalties.score;
                }
                
                // Ensure score doesn't go below 0 or above 100
                totalScore = Math.max(0, Math.min(totalScore, 100));
                totalScore = Math.round(totalScore);
                
                // Update requirement indicators
                updateRequirements(password, totalScore, breachResult);
                
                // Generate alerts
                if (password.length > 0) {
                    alerts = generateAlerts(password, breakdown, breachResult);
                }
                
                // Display alerts
                displayAlerts(alerts);
                
                // Update strength meter
                updateStrengthMeter(totalScore);
                
                // Update result display
                updateResultDisplay(password, totalScore, breakdown, breachResult);
                
                // Update score breakdown display
                updateScoreBreakdown(breakdown, totalScore, breachResult);
                
                // Show breach data if found
                if (breachResult.found) {
                    showBreachData(breachResult);
                }
            }

            // Calculate length score
            function calculateLengthScore(password) {
                const length = password.length;
                let score = 0;
                let items = [];
                
                if (length === 0) {
                    return { score: 0, items: ['No password entered'] };
                }
                
                if (length >= 20) {
                    score = 25;
                    items.push('Excellent length (20+ chars): +25');
                } else if (length >= 16) {
                    score = 20;
                    items.push('Very good length (16-19 chars): +20');
                } else if (length >= 12) {
                    score = 15;
                    items.push('Good length (12-15 chars): +15');
                } else if (length >= 8) {
                    score = 10;
                    items.push('Minimum acceptable (8-11 chars): +10');
                } else if (length >= 6) {
                    score = 5;
                    items.push('Very short (6-7 chars): +5');
                } else {
                    score = 2;
                    items.push('Extremely short (<6 chars): +2');
                }
                
                if (length >= 24) {
                    score = Math.min(score + 5, 25);
                    items.push('Extra long bonus: +5');
                }
                
                return { score: score, items: items };
            }

            // Calculate complexity score
            function calculateComplexityScore(password) {
                let score = 0;
                let items = [];
                
                const hasUppercase = /[A-Z]/.test(password);
                const hasLowercase = /[a-z]/.test(password);
                const hasNumbers = /\d/.test(password);
                const hasSpecial = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password);
                
                let charTypeCount = 0;
                if (hasUppercase) { score += 5; items.push('Uppercase letters: +5'); charTypeCount++; }
                if (hasLowercase) { score += 5; items.push('Lowercase letters: +5'); charTypeCount++; }
                if (hasNumbers) { score += 5; items.push('Numbers: +5'); charTypeCount++; }
                if (hasSpecial) { score += 10; items.push('Special characters: +10'); charTypeCount++; }
                
                if (hasUppercase && hasLowercase && hasNumbers && hasSpecial) {
                    score += 5;
                    items.push('All character types bonus: +5');
                }
                
                score = Math.min(score, 30);
                
                return { score: score, items: items, charTypeCount: charTypeCount };
            }

            // Calculate security score
            function calculateSecurityScore(password) {
                let score = 25;
                let items = [];
                
                const isCommon = commonPasswords.includes(password.toLowerCase());
                if (isCommon) {
                    score -= 15;
                    items.push('Common password: -15');
                }
                
                // Check for dictionary words
                if (password.length > 0 && password.match(/password|admin|welcome|sunshine|dragon|football|baseball/i)) {
                    score -= 10;
                    items.push('Contains dictionary word: -10');
                }
                
                score = Math.max(score, 0);
                
                if (items.length === 0) {
                    items.push('No security issues found: +25');
                }
                
                return { score: score, items: items };
            }

            // Calculate penalties
            function calculatePenalties(password) {
                let totalPenalty = 0;
                let penaltyItems = [];
                
                for (const patternInfo of weakPatterns) {
                    if (patternInfo.pattern.test(password)) {
                        const penalty = Math.floor(patternInfo.severity / 2);
                        totalPenalty -= penalty;
                        penaltyItems.push(`${patternInfo.name}: -${penalty}`);
                    }
                }
                
                if (password.length < 6) {
                    totalPenalty -= 10;
                    penaltyItems.push(`Very short (<6 chars): -10`);
                } else if (password.length < 8) {
                    totalPenalty -= 5;
                    penaltyItems.push(`Short (<8 chars): -5`);
                }
                
                if (!/[A-Z]/.test(password)) {
                    totalPenalty -= 3;
                    penaltyItems.push(`No uppercase letters: -3`);
                }
                if (!/[a-z]/.test(password)) {
                    totalPenalty -= 3;
                    penaltyItems.push(`No lowercase letters: -3`);
                }
                if (!/\d/.test(password)) {
                    totalPenalty -= 3;
                    penaltyItems.push(`No numbers: -3`);
                }
                if (!/[^a-zA-Z0-9]/.test(password)) {
                    totalPenalty -= 3;
                    penaltyItems.push(`No special characters: -3`);
                }
                
                return { score: totalPenalty, items: penaltyItems };
            }

            // Simulated breach check
            async function checkPasswordBreach(password) {
                if (password.length < 4) {
                    return { found: false, count: 0, message: "Password too short for breach check" };
                }
                
                // Simulate API call with timeout
                return new Promise(resolve => {
                    setTimeout(() => {
                        // Simulate checking against common passwords
                        if (commonPasswords.includes(password.toLowerCase())) {
                            resolve({
                                found: true,
                                count: Math.floor(Math.random() * 10000) + 1000,
                                message: `This password was found in data breaches.`,
                                sources: [
                                    { name: 'Collection #1-3', date: '2019-2020', accounts: 'Multiple billions' },
                                    { name: 'RockYou', date: '2009', accounts: '32 million' }
                                ]
                            });
                        } else {
                            resolve({ 
                                found: false, 
                                count: 0, 
                                message: "No breaches found - This password is not in our database"
                            });
                        }
                    }, 800);
                });
            }

            // Update requirement indicators
            function updateRequirements(password, totalScore, breachResult) {
                const hasUppercase = /[A-Z]/.test(password);
                const hasLowercase = /[a-z]/.test(password);
                const hasNumbers = /\d/.test(password);
                const hasSpecial = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password);
                const isCommon = commonPasswords.includes(password.toLowerCase());
                const hasWeakPatterns = weakPatterns.some(p => p.pattern.test(password));
                const isBreached = breachResult.found;
                
                updateRequirementIndicator('length', password.length >= 12);
                updateRequirementIndicator('uppercase', hasUppercase);
                updateRequirementIndicator('lowercase', hasLowercase);
                updateRequirementIndicator('numbers', hasNumbers);
                updateRequirementIndicator('special', hasSpecial);
                updateRequirementIndicator('noCommon', !isCommon);
                updateRequirementIndicator('notBreached', !isBreached);
                updateRequirementIndicator('noPatterns', !hasWeakPatterns);
            }

            // Update requirement indicator
            function updateRequirementIndicator(type, isMet) {
                const req = reqElements[type];
                if (isMet) {
                    req.icon.className = 'fas fa-check-circle requirement-icon requirement-met';
                    req.item.style.color = '#00ff88';
                } else {
                    req.icon.className = 'fas fa-times-circle requirement-icon requirement-not-met';
                    req.item.style.color = '#ff5555';
                }
            }

            // Generate alerts
            function generateAlerts(password, breakdown, breachResult) {
                const alerts = [];
                const totalScore = breakdown.length.score + breakdown.complexity.score + 
                                 breakdown.security.score + breakdown.penalties.score;
                
                // Length alerts
                if (password.length < 8) {
                    alerts.push({
                        type: 'danger',
                        title: 'Password Too Short',
                        message: 'Passwords shorter than 8 characters are extremely weak.',
                        icon: 'fas fa-exclamation-triangle'
                    });
                } else if (password.length < 12) {
                    alerts.push({
                        type: 'warning',
                        title: 'Password Could Be Longer',
                        message: 'Consider using at least 12 characters for better security.',
                        icon: 'fas fa-ruler'
                    });
                }
                
                // Complexity alerts
                if (!/[A-Z]/.test(password)) {
                    alerts.push({
                        type: 'warning',
                        title: 'Missing Uppercase Letters',
                        message: 'Add uppercase letters (A-Z) to increase password strength.',
                        icon: 'fas fa-text-height'
                    });
                }
                
                if (!/[a-z]/.test(password)) {
                    alerts.push({
                        type: 'warning',
                        title: 'Missing Lowercase Letters',
                        message: 'Add lowercase letters (a-z) to increase password strength.',
                        icon: 'fas fa-text-width'
                    });
                }
                
                if (!/\d/.test(password)) {
                    alerts.push({
                        type: 'warning',
                        title: 'Missing Numbers',
                        message: 'Add numbers (0-9) to increase password strength.',
                        icon: 'fas fa-hashtag'
                    });
                }
                
                if (!/[^a-zA-Z0-9]/.test(password)) {
                    alerts.push({
                        type: 'warning',
                        title: 'Missing Special Characters',
                        message: 'Add special characters (!@#$%^&*) to increase password strength.',
                        icon: 'fas fa-asterisk'
                    });
                }
                
                // Security alerts
                if (commonPasswords.includes(password.toLowerCase())) {
                    alerts.push({
                        type: 'danger',
                        title: 'Common Password Detected',
                        message: 'This password is among the most commonly used passwords worldwide.',
                        icon: 'fas fa-users'
                    });
                }
                
                if (breachResult.found) {
                    alerts.push({
                        type: 'danger',
                        title: 'PASSWORD BREACHED!',
                        message: `This password was found ${breachResult.count.toLocaleString()} times in data breaches.`,
                        icon: 'fas fa-skull-crossbones'
                    });
                }
                
                // Weak pattern alerts
                for (const patternInfo of weakPatterns) {
                    if (patternInfo.pattern.test(password)) {
                        alerts.push({
                            type: patternInfo.severity >= 25 ? 'danger' : 'warning',
                            title: `Weak Pattern: ${patternInfo.name}`,
                            message: `This pattern makes your password easier to guess.`,
                            icon: 'fas fa-exclamation-circle'
                        });
                        break;
                    }
                }
                
                // Success alert for strong passwords
                if (totalScore >= 90 && !breachResult.found) {
                    alerts.push({
                        type: 'success',
                        title: 'Excellent Password!',
                        message: 'Your password exceeds all security requirements and is breach-free!',
                        icon: 'fas fa-shield-alt'
                    });
                } else if (totalScore >= 80 && !breachResult.found) {
                    alerts.push({
                        type: 'success',
                        title: 'Strong Password!',
                        message: 'Your password meets all security requirements and is not breached.',
                        icon: 'fas fa-check-circle'
                    });
                }
                
                return alerts;
            }

            // Display breach data
            function showBreachData(breachInfo) {
                breachDataDiv.style.display = 'block';
                breachSourcesDiv.style.display = 'block';
                
                let breachHTML = '';
                
                breachHTML += `
                    <div class="breach-item">
                        <div class="breach-label">Password Status</div>
                        <div class="breach-value" style="color: #ff5555;">COMPROMISED</div>
                    </div>
                    <div class="breach-item">
                        <div class="breach-label">Times Found in Breaches</div>
                        <div class="breach-value">${breachInfo.count.toLocaleString()}</div>
                    </div>
                    <div class="breach-item">
                        <div class="breach-label">Risk Level</div>
                        <div class="breach-value" style="color: #ff5555">HIGH</div>
                    </div>
                    <div class="breach-item">
                        <div class="breach-label">Data Source</div>
                        <div class="breach-value">HIBP Database</div>
                    </div>
                `;
                
                breachInfoDiv.innerHTML = breachHTML;
                
                // Show breach sources if available
                if (breachInfo.sources && breachInfo.sources.length > 0) {
                    let sourcesHTML = '';
                    
                    breachInfo.sources.forEach(source => {
                        sourcesHTML += `
                            <li class="breach-source-item">
                                <span class="breach-source-name">${source.name}</span>
                                <span class="breach-source-count">${source.date}  ${source.accounts}</span>
                            </li>
                        `;
                    });
                    
                    breachSourceList.innerHTML = sourcesHTML;
                }
            }

            // Display alerts
            function displayAlerts(alerts) {
                alertContainer.innerHTML = '';
                
                if (alerts.length === 0) return;
                
                // Limit to 4 most important alerts
                const displayAlerts = alerts.slice(0, 4);
                
                for (const alert of displayAlerts) {
                    const alertElement = document.createElement('div');
                    alertElement.className = `alert alert-${alert.type}`;
                    alertElement.innerHTML = `
                        <i class="${alert.icon} alert-icon"></i>
                        <div class="alert-content">
                            <div class="alert-title">${alert.title}</div>
                            <div class="alert-message">${alert.message}</div>
                        </div>
                    `;
                    alertContainer.appendChild(alertElement);
                }
            }

            // Clear all alerts
            function clearAlerts() {
                alertContainer.innerHTML = '';
            }

            // Update strength meter
            function updateStrengthMeter(strengthPercent) {
                strengthFill.style.width = `${strengthPercent}%`;
                
                if (strengthPercent === 100) {
                    strengthFill.style.background = 'linear-gradient(90deg, #00ff88, #00cc66, #00ff88)';
                    strengthText.textContent = 'PERFECT 100';
                    strengthText.style.color = '#00ff88';
                } else if (strengthPercent >= 90) {
                    strengthFill.style.background = 'linear-gradient(90deg, #00ff88, #00cc66)';
                    strengthText.textContent = 'Excellent';
                    strengthText.style.color = '#00ff88';
                } else if (strengthPercent >= 80) {
                    strengthFill.style.background = 'linear-gradient(90deg, #00ff88, #00cc66)';
                    strengthText.textContent = 'Strong';
                    strengthText.style.color = '#00ff88';
                } else if (strengthPercent >= 60) {
                    strengthFill.style.background = 'linear-gradient(90deg, #a0ff60, #80ff00)';
                    strengthText.textContent = 'Good';
                    strengthText.style.color = '#a0ff60';
                } else if (strengthPercent >= 40) {
                    strengthFill.style.background = 'linear-gradient(90deg, #ffaa00, #ff8800)';
                    strengthText.textContent = 'Fair';
                    strengthText.style.color = '#ffaa00';
                } else if (strengthPercent >= 20) {
                    strengthFill.style.background = 'linear-gradient(90deg, #ff5555, #ff0000)';
                    strengthText.textContent = 'Weak';
                    strengthText.style.color = '#ff5555';
                } else {
                    strengthFill.style.background = 'linear-gradient(90deg, #ff5555, #ff0000)';
                    strengthText.textContent = 'Very Weak';
                    strengthText.style.color = '#ff5555';
                }
            }

            // Update result display
            function updateResultDisplay(password, strengthPercent, breakdown, breachResult) {
                if (password.length > 0) {
                    resultDiv.style.display = 'block';
                    
                    // Calculate character types
                    const hasUppercase = /[A-Z]/.test(password);
                    const hasLowercase = /[a-z]/.test(password);
                    const hasNumbers = /\d/.test(password);
                    const hasSpecial = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password);
                    
                    let charTypeCount = 0;
                    if (hasUppercase) charTypeCount++;
                    if (hasLowercase) charTypeCount++;
                    if (hasNumbers) charTypeCount++;
                    if (hasSpecial) charTypeCount++;
                    
                    // Set result class and message based on strength and breach status
                    if (breachResult.found) {
                        resultDiv.className = 'result result-weak';
                        resultTitle.textContent = 'COMPROMISED PASSWORD';
                        resultMessage.textContent = `This password was found ${breachResult.count.toLocaleString()} times in data breaches.`;
                        scoreValue.className = 'detail-value score-poor';
                        breachStatus.textContent = 'BREACHED';
                        breachStatus.style.color = '#ff5555';
                    } else if (strengthPercent === 100) {
                        resultDiv.className = 'result result-strong';
                        resultTitle.textContent = 'PERFECT SCORE 100/100!';
                        resultMessage.textContent = 'This password exceeds all security requirements and is breach-free!';
                        scoreValue.className = 'detail-value score-excellent';
                        breachStatus.textContent = 'SAFE';
                        breachStatus.style.color = '#00ff88';
                    } else if (strengthPercent >= 90) {
                        resultDiv.className = 'result result-strong';
                        resultTitle.textContent = 'Excellent Password!';
                        resultMessage.textContent = 'Your password exceeds all security requirements and is breach-free.';
                        scoreValue.className = 'detail-value score-excellent';
                        breachStatus.textContent = 'SAFE';
                        breachStatus.style.color = '#00ff88';
                    } else if (strengthPercent >= 80) {
                        resultDiv.className = 'result result-strong';
                        resultTitle.textContent = 'Strong Password!';
                        resultMessage.textContent = 'Your password meets all security requirements and is breach-free.';
                        scoreValue.className = 'detail-value score-excellent';
                        breachStatus.textContent = 'SAFE';
                        breachStatus.style.color = '#00ff88';
                    } else if (strengthPercent >= 60) {
                        resultDiv.className = 'result result-medium';
                        resultTitle.textContent = 'Good Password';
                        resultMessage.textContent = 'Your password provides reasonable protection but could be stronger.';
                        scoreValue.className = 'detail-value score-good';
                        breachStatus.textContent = 'SAFE';
                        breachStatus.style.color = '#00ff88';
                    } else if (strengthPercent >= 40) {
                        resultDiv.className = 'result result-medium';
                        resultTitle.textContent = 'Fair Password';
                        resultMessage.textContent = 'Your password meets some requirements but needs improvement.';
                        scoreValue.className = 'detail-value score-fair';
                        breachStatus.textContent = 'WEAK';
                        breachStatus.style.color = '#ffaa00';
                    } else if (strengthPercent >= 20) {
                        resultDiv.className = 'result result-weak';
                        resultTitle.textContent = 'Weak Password';
                        resultMessage.textContent = 'Your password does not meet basic security requirements.';
                        scoreValue.className = 'detail-value score-poor';
                        breachStatus.textContent = 'VERY WEAK';
                        breachStatus.style.color = '#ff5555';
                    } else {
                        resultDiv.className = 'result result-weak';
                        resultTitle.textContent = 'Very Weak Password';
                        resultMessage.textContent = 'Your password is extremely vulnerable to attacks.';
                        scoreValue.className = 'detail-value score-poor';
                        breachStatus.textContent = 'HIGH RISK';
                        breachStatus.style.color = '#ff5555';
                    }
                    
                    // Update metrics
                    scoreValue.textContent = `${strengthPercent}/100`;
                    passwordLength.textContent = password.length;
                    charTypes.textContent = `${charTypeCount}/4`;
                } else {
                    resultDiv.style.display = 'none';
                }
            }

            // Update score breakdown display
            function updateScoreBreakdown(breakdown, totalScore, breachResult) {
                let breakdownHTML = '';
                
                // Length category
                breakdownHTML += `
                    <div class="score-category">
                        <div class="category-header">
                            <span class="category-name">Length & Structure</span>
                            <span class="category-score">${breakdown.length.score}/${breakdown.length.max}</span>
                        </div>
                        <div class="score-meter">
                            <div class="score-fill" style="width: ${(breakdown.length.score/breakdown.length.max)*100}%; background: ${breakdown.length.score >= 20 ? '#00ff88' : breakdown.length.score >= 15 ? '#a0ff60' : '#ffaa00'};"></div>
                        </div>
                        <div class="score-items">
                            ${breakdown.length.items.map(item => `<div class="score-item">${item}</div>`).join('')}
                        </div>
                    </div>
                `;
                
                // Complexity category
                breakdownHTML += `
                    <div class="score-category">
                        <div class="category-header">
                            <span class="category-name">Character Complexity</span>
                            <span class="category-score">${breakdown.complexity.score}/${breakdown.complexity.max}</span>
                        </div>
                        <div class="score-meter">
                            <div class="score-fill" style="width: ${(breakdown.complexity.score/breakdown.complexity.max)*100}%; background: ${breakdown.complexity.score >= 25 ? '#00ff88' : breakdown.complexity.score >= 20 ? '#a0ff60' : '#ffaa00'};"></div>
                        </div>
                        <div class="score-items">
                            ${breakdown.complexity.items.map(item => `<div class="score-item">${item}</div>`).join('')}
                        </div>
                    </div>
                `;
                
                // Security category
                let securityItems = [...breakdown.security.items];
                if (breachResult.found) {
                    const penalty = breachResult.count > 10000 ? 20 : breachResult.count > 1000 ? 15 : 10;
                    securityItems.push(`<span class="penalty">Found in ${breachResult.count.toLocaleString()} breaches: -${penalty}</span>`);
                }
                
                breakdownHTML += `
                    <div class="score-category">
                        <div class="category-header">
                            <span class="category-name">Security & Uniqueness</span>
                            <span class="category-score">${breakdown.security.score}/${breakdown.security.max}</span>
                        </div>
                        <div class="score-meter">
                            <div class="score-fill" style="width: ${(breakdown.security.score/breakdown.security.max)*100}%; background: ${breakdown.security.score >= 20 ? '#00ff88' : breakdown.security.score >= 15 ? '#a0ff60' : '#ffaa00'};"></div>
                        </div>
                        <div class="score-items">
                            ${securityItems.map(item => `<div class="score-item">${item}</div>`).join('')}
                        </div>
                    </div>
                `;
                
                // Penalties category
                if (breakdown.penalties.items.length > 0) {
                    breakdownHTML += `
                        <div class="score-category">
                            <div class="category-header">
                                <span class="category-name">Weaknesses & Penalties</span>
                                <span class="category-score penalty">${breakdown.penalties.score}</span>
                            </div>
                            <div class="score-meter">
                                <div class="score-fill" style="width: ${breakdown.penalties.max > 0 ? (Math.abs(breakdown.penalties.score)/breakdown.penalties.max)*100 : 0}%; background: #ff5555;"></div>
                            </div>
                            <div class="score-items">
                                ${breakdown.penalties.items.map(item => `<div class="score-item penalty">${item}</div>`).join('')}
                            </div>
                        </div>
                    `;
                }
                
                // Total score
                breakdownHTML += `
                    <div style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid rgba(100, 100, 150, 0.3);">
                        <div class="category-header">
                            <span class="category-name" style="font-size: 1.2rem;">Total Security Score</span>
                            <span class="category-score" style="font-size: 1.5rem; color: ${totalScore === 100 ? '#00ff88' : totalScore >= 90 ? '#00ff88' : totalScore >= 80 ? '#00ff88' : totalScore >= 60 ? '#a0ff60' : totalScore >= 40 ? '#ffaa00' : '#ff5555'}">${totalScore}/100</span>
                        </div>
                    </div>
                `;
                
                breakdownContent.innerHTML = breakdownHTML;
            }
        });
    </script>
</body>
</html>
